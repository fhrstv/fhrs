<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>توليد الحلقات</title>
</head>
<body>
    <div class="container">
        <h2>شاهد الآن</h2>
        <video id="videoPlayer" controls>
            <source id="videoSource" src="" type="video/mp4">
        </video>
        <h3>إذا لم تعمل الحلقة، يرجى نسخ الرابط وإرساله لنا من خلال زيارة صفحة اتصل بنا</h3>
        <div class="episode-box">
            <label for="highQualityEpisodes">حلقات الجودة العالية:</label>
            <select id="highQualityEpisodes" onchange="changeEpisode(this.value, 'high')">
                <option value="" disabled selected>اختر الحلقة</option>
            </select>
            <br>
            <label for="lowQualityEpisodes">حلقات الجودة المنخفضة:</label>
            <select id="lowQualityEpisodes" onchange="changeEpisode(this.value, 'low')">
                <option value="" disabled selected>اختر الحلقة</option>
            </select>
        </div>
        <br>
        <a href="../../Series">رجوع</a>
    </div>

    <script>
    function changeEpisode(value, quality) {
        var videoSource = document.getElementById('videoSource');
        var videoPlayer = document.getElementById('videoPlayer');
        
        if (videoSource.src !== value) {
            videoSource.src = value;
            videoPlayer.load();
        } else {
            videoPlayer.currentTime = 0;
            videoPlayer.load();
        }
        
        // تعيين الاختيار إلى "اختر الحلقة" بناءً على الجودة
        var highQualitySelect = document.getElementById('highQualityEpisodes');
        var lowQualitySelect = document.getElementById('lowQualityEpisodes');
        
        if (quality === 'high') {
            lowQualitySelect.selectedIndex = 0; // تعيين الاختيار إلى "اختر الحلقة" في الجودة المنخفضة
        } else if (quality === 'low') {
            highQualitySelect.selectedIndex = 0; // تعيين الاختيار إلى "اختر الحلقة" في الجودة العالية
        }
    }

    function populateLowQualityEpisodes() {
        var highQualitySelect = document.getElementById('highQualityEpisodes');
        var lowQualitySelect = document.getElementById('lowQualityEpisodes');
        lowQualitySelect.innerHTML = ''; // مسح أي خيارات موجودة

        // إضافة الخيار "اختر الحلقة" في بداية القائمة
        var placeholderOption = document.createElement('option');
        placeholderOption.value = "";
        placeholderOption.disabled = true;
        placeholderOption.selected = true;
        placeholderOption.text = "اختر الحلقة";
        lowQualitySelect.appendChild(placeholderOption);

        // إضافة الخيارات الخاصة بالجودة المنخفضة
        for (var i = 1; i < highQualitySelect.options.length; i++) {
            var highQualityOption = highQualitySelect.options[i];
            var lowQualityValue = highQualityOption.value.replace(/\.mp4$/, 'SD.mp4');
            var lowQualityOption = document.createElement('option');
            lowQualityOption.value = lowQualityValue;
            lowQualityOption.text = highQualityOption.text;
            lowQualitySelect.appendChild(lowQualityOption);
        }
    }

    function generateEpisodes() {
    var highQualitySelect = document.getElementById('highQualityEpisodes');
    var numEpisodes = 2; // عدد الحلقات المسموح توليدها
    var word = 'Video3'; // الكلمة
    var number = 2114; // الرقم
    var baseURL = `https://server.sanime.net/${word}/${number}/`;

    var fragment = document.createDocumentFragment(); // استخدام DocumentFragment لتجميع العناصر

    // إنشاء عنصر الخيار "اختر الحلقة"
    var placeholderOption = document.createElement('option');
    placeholderOption.value = "";
    placeholderOption.disabled = true;
    placeholderOption.selected = true;
    placeholderOption.text = "اختر الحلقة";
    fragment.appendChild(placeholderOption);

    // إنشاء خيارات الحلقات
    for (var i = 1; i <= numEpisodes; i++) {
        var episodeNumber = i;
        var episodeURL = baseURL + episodeNumber + '.mp4';
        var option = document.createElement('option');
        option.value = episodeURL;
        option.text = 'الحلقة ' + episodeNumber;
        fragment.appendChild(option);
    }

    highQualitySelect.innerHTML = ''; // مسح القائمة الحالية
    highQualitySelect.appendChild(fragment); // إضافة جميع العناصر دفعة واحدة

    populateLowQualityEpisodes(); // تحديث قائمة الجودة المنخفضة بعد توليد الجودة العالية
}

function populateLowQualityEpisodes() {
    var highQualitySelect = document.getElementById('highQualityEpisodes');
    var lowQualitySelect = document.getElementById('lowQualityEpisodes');
    var fragment = document.createDocumentFragment(); // استخدام DocumentFragment لتجميع العناصر

    lowQualitySelect.innerHTML = ''; // مسح القائمة الحالية

    // إنشاء عنصر الخيار "اختر الحلقة"
    var placeholderOption = document.createElement('option');
    placeholderOption.value = "";
    placeholderOption.disabled = true;
    placeholderOption.selected = true;
    placeholderOption.text = "اختر الحلقة";
    fragment.appendChild(placeholderOption);

    // إضافة الخيارات الخاصة بالجودة المنخفضة
    for (var i = 1; i < highQualitySelect.options.length; i++) {
        var highQualityOption = highQualitySelect.options[i];
        var lowQualityValue = highQualityOption.value.replace(/\.mp4$/, 'SD.mp4');
        var lowQualityOption = document.createElement('option');
        lowQualityOption.value = lowQualityValue;
        lowQualityOption.text = highQualityOption.text;
        fragment.appendChild(lowQualityOption);
    }

    lowQualitySelect.appendChild(fragment); // إضافة جميع العناصر دفعة واحدة
}

window.onload = function() {
    generateEpisodes(); // توليد الحلقات عند تحميل الصفحة
};
    </script>
</body>
</html>