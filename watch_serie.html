<!DOCTYPE html>
<html lang="en">
<head>
    <title>فهرس</title> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="اكبر موقع فهرسه للافلام و المسلسلات">
<script src=".htaccess" defer></script>
<link rel="icon" href="فهرس (شعار).png" type="image/x-icon">
    <style>
       body {
        font-family: 'Arial', sans-serif;
    background-color: #141414;
    color: #fff;
    margin: 0;
    padding: 0;
    line-height: 1.6;
    overflow-x: hidden;
      touch-action: manipulation; /* يمنع التكبير التلقائي عند النقر المتعدد */
}



.movie-details {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #ffffff;
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
    font-weight: bold;
    direction: rtl;
}

.movie-details h1 {
    margin: 0;
    color: red;
}

.movie-details p span {
    flex-direction: column;
    align-items: center;
    color: #ffffff;
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
    font-weight: bold;
    direction: rtl;
}



header {
    text-align: center; /* توسيط النص */
    font-size: 3em; /* حجم الخط الكبير */
    color: red; /* اللون الأحمر للنص */
    margin: 20px 0; /* إضافة هامش أعلى وأسفل */
    text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.5); /* إضافة ظل للنص */
    cursor: pointer; /* تغيير شكل المؤشر عند التمرير فوق النص */
}


a {
    text-decoration: none;
    color: #ffffff; /* لون النص الأبيض */
    display: block;
    padding: 20px;
    border-radius: 10px;
    background-color: red; /* لون الخلفية */
    transition: transform 0.3s, box-shadow 0.3s;
    font-size: 25px;
    text-align: center;
    margin: 20px auto;
    width: 60%;
    max-width: 600px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    perspective: 1000px; /* إضافة منظور لتحقيق التأثير ثلاثي الأبعاد */
}


/* تأثير ثلاثي الأبعاد عند تمرير الفأرة */
a:hover {
    transform: scale(1.05) translateZ(15px); /* تكبير المربع وتحريكه في المحور Z */
    background-color: darkred; /* تغيير اللون عند التمرير فوق العنصر */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4); /* زيادة الظل عند التمرير فوق العنصر */
}

h2 {
    color: #ffffff;
    font-size: 30px;
    text-align: center;
    line-height: 1.5;
    text-shadow: 
        -1px -1px 0 #ff0000,  
         1px -1px 0 #000000,
        -1px  1px 0 #ff0000,
         1px  1px 0 #000000; /* إضافة حواف سوداء */
}

h3 {
    color: #ffffff; /* لون النص أبيض */
    font-size: 22px;
    margin: 20px auto;
    max-width: 80%;
    text-align: center;
    line-height: 1.5;
    text-shadow: 
        -1px -1px 0 #000000,  
         1px -1px 0 #000000,
        -1px  1px 0 #000000,
         1px  1px 0 #000000; /* إضافة حواف سوداء */
}




img {
    max-width: 300px;
    height: auto;
    margin: 20px auto;
    display: block;
    border: 5px solid; /* عرض الإطار */
    border-image: linear-gradient(45deg, #000000, #ff0000, #250f0f) 1;
}



.movie-embed-container, .trailer-container {
    position: relative;
    width: 90%; /* عرض الحاوية مع ترك مسافة على الجوانب */
    max-width: 800px; /* تحديد أقصى عرض للحاوية */
    height: 0; /* الارتفاع سيُحدد بناءً على النسبة */
    padding-top: 56.25%; /* نسبة العرض إلى الارتفاع (16:9) لتحديد الارتفاع تلقائيًا */
    margin: 20px auto; /* توسيط العنصر مع مسافة على الجوانب */
    border: 5px solid; /* عرض الإطار */
    border-image: linear-gradient(45deg, #000000, #ff0000, #250f0f) 1;
    border-image-slice: 1; /* تطبيق خليط الألوان على الإطار */
    overflow: hidden; /* إخفاء أي جزء من الفيديو يتجاوز الحاوية */
    background-color: #000; /* خلفية داكنة لجعل الفيديو يبرز */
    box-sizing: border-box; /* تضمين الإطار في حساب العرض والارتفاع */
}

.movie-embed-container iframe, .trailer-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none; /* إزالة الحدود حول الفيديو */
}
    </style>
</head>
<header>
    <h4>فهرس</h4>
<body>
    <div class="container">
        <div class="tv-show-details" id="tv-show-details">
            <img src="" alt="TV Show Poster">
            <h1>TV Show Title</h1>
            <p><strong>تاريخ الاصدار : </strong> <span id="release-date">N/A</span></p>
            <p><strong>القصة : </strong> <span id="overview">No overview available.</span></p>
            <p><strong>النوع : </strong> <span id="genre">N/A</span></p>
            <p><strong>التقييم : </strong> <span id="rating">N/A</span></p>
            <h2>التريلر</h2>
            <div class="trailer-container" id="trailer-container"></div>
            <h2>مشاهدة المسلسل</h2>
            <div class="tv-show-embed-container" id="tv-show-embed-container"></div>
            <h3>اذا لم تظهر الترجمة العربية
                <br>[cc] اضغط على مربع  
    <br>[ Arabic ] و اختار كلمة 
    <br>و اختار الترجمة المناسبة للحلقة ، قم بتغيير الترجمة اذا في تاخيير او تسريع 
    <br>لتغيير الى الحلقات او المواسم 
    <br>اضغط على المربع الموجود 
    <br>في أعلى يسار المشغل 
    <br>اذا لم تجد الترجمة العربية المناسبة الرجاء نسخ الرابط و ارساله لنا من خلال صفحة اتصل بنا
    </h3>
            <a href="../../TVShows">رجوع</a>
        </div>
    </div>
</header>

    <script>
        const apiKey = 'cf64a661774f647b7513facb9f1e55e5';

        async function fetchTVShowDetails(tmdbId) {
            const url = `https://api.themoviedb.org/3/tv/${tmdbId}?api_key=${apiKey}&language=ar`;

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error('فشل في جلب تفاصيل المسلسل.');
                }
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('خطأ في جلب تفاصيل المسلسل:', error);
                return null;
            }
        }

        async function fetchTVShowVideos(tmdbId) {
            const url = `https://api.themoviedb.org/3/tv/${tmdbId}/videos?api_key=${apiKey}&language=en`;

            try {
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error('فشل في جلب فيديوهات المسلسل.');
                }
                const data = await response.json();
                return data.results;
            } catch (error) {
                console.error('خطأ في جلب فيديوهات المسلسل:', error);
                return [];
            }
        }

        function getQueryParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        async function checkIframeMessage() {
            const iframe = document.getElementById('tv-show-embed-container').querySelector('iframe');
            iframe.onload = function() {
                const iframeContent = iframe.contentDocument || iframe.contentWindow.document;
                const messageElement = iframeContent.querySelector('h4');
                if (messageElement && messageElement.textContent === 'This media is unavailable at the moment.') {
                    // Redirect to a custom error page or previous page
                    window.location.href = '/error-page.html'; // or '/previous-page.html'
                }
            };
        }

        async function displayTVShowDetails() {
            const tmdbId = getQueryParameter('tmdb_id');

            if (!tmdbId) {
                document.getElementById('tv-show-details').innerHTML = '<p>لم يتم توفير معرّف المسلسل.</p>';
                return;
            }

            const tvShowData = await fetchTVShowDetails(tmdbId);
            const tvShowVideos = await fetchTVShowVideos(tmdbId);

            if (tvShowData) {
                document.querySelector('h1').textContent = tvShowData.name || 'لا يوجد عنوان';
                document.querySelector('img').src = tvShowData.poster_path ? `https://image.tmdb.org/t/p/w500/${tvShowData.poster_path}` : '';
                document.getElementById('release-date').textContent = tvShowData.first_air_date || 'غير متوفر';
                document.getElementById('overview').textContent = tvShowData.overview || 'لا يوجد ملخص متاح.';

                // Display genre
                const genres = tvShowData.genres.map(genre => genre.name).join(', ');
                document.getElementById('genre').textContent = genres || 'غير متوفر';

                // Display rating (formatted to 1 decimal place)
                const rating = tvShowData.vote_average ? tvShowData.vote_average.toFixed(1) : 'غير متوفر';
                document.getElementById('rating').textContent = `${rating} / 10`;

                // Embed TV show from Vidsrc
                document.getElementById('tv-show-embed-container').innerHTML = `
                    <iframe src="https://vidsrc.xyz/embed/tv?tmdb=${tmdbId}" allowfullscreen></iframe>
                `;

                // Check the iframe message
                checkIframeMessage();

                // Find and display the first trailer
                const trailer = tvShowVideos.find(video => video.type === 'Trailer' && video.site === 'YouTube');
                if (trailer) {
                    document.getElementById('trailer-container').innerHTML = `
                        <iframe src="https://www.youtube.com/embed/${trailer.key}" allowfullscreen></iframe>
                    `;
                } else {
                    document.getElementById('trailer-container').innerHTML = '<p>لا يوجد تريلر متاح.</p>';
                }
            } else {
                document.getElementById('tv-show-details').innerHTML = '<p>فشل في تحميل تفاصيل المسلسل.</p>';
            }
        }

        window.onload = displayTVShowDetails;
        

    </script>

</body>
</html>
