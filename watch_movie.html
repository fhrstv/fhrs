<!DOCTYPE html>
<html lang="en">
<head>
    <title>فهرس</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="اكبر موقع فهرسه للافلام و المسلسلات">
<script src=".htaccess" defer></script>
<link rel="icon" href="فهرس (شعار).png" type="image/x-icon">
    <style>
 body {
        font-family: 'Arial', sans-serif;
    background-color: #141414;
    color: #fff;
    margin: 0;
    padding: 0;
    line-height: 1.6;
    overflow-x: hidden;
      touch-action: manipulation; /* يمنع التكبير التلقائي عند النقر المتعدد */
}



.movie-details {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #ffffff;
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
    font-weight: bold;
    direction: rtl;
}

.movie-details h1 {
    margin: 0;
    color: red;
}

.movie-details p span {
    flex-direction: column;
    align-items: center;
    color: #ffffff;
    font-size: 20px;
    margin-bottom: 10px;
    text-align: center;
    font-weight: bold;
    direction: rtl;
}



header {
    text-align: center; /* توسيط النص */
    font-size: 3em; /* حجم الخط الكبير */
    color: red; /* اللون الأحمر للنص */
    margin: 20px 0; /* إضافة هامش أعلى وأسفل */
    text-shadow: 3px 3px 5px rgba(0, 0, 0, 0.5); /* إضافة ظل للنص */
    cursor: pointer; /* تغيير شكل المؤشر عند التمرير فوق النص */
}


a {
    text-decoration: none;
    color: #ffffff; /* لون النص الأبيض */
    display: block;
    padding: 20px;
    border-radius: 10px;
    background-color: red; /* لون الخلفية */
    transition: transform 0.3s, box-shadow 0.3s;
    font-size: 25px;
    text-align: center;
    margin: 20px auto;
    width: 60%;
    max-width: 600px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    perspective: 1000px; /* إضافة منظور لتحقيق التأثير ثلاثي الأبعاد */
}


/* تأثير ثلاثي الأبعاد عند تمرير الفأرة */
a:hover {
    transform: scale(1.05) translateZ(15px); /* تكبير المربع وتحريكه في المحور Z */
    background-color: darkred; /* تغيير اللون عند التمرير فوق العنصر */
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4); /* زيادة الظل عند التمرير فوق العنصر */
}

h2 {
    color: #ffffff;
    font-size: 30px;
    text-align: center;
    line-height: 1.5;
    text-shadow: 
        -1px -1px 0 #ff0000,  
         1px -1px 0 #000000,
        -1px  1px 0 #ff0000,
         1px  1px 0 #000000; /* إضافة حواف سوداء */
}

h3 {
    color: #ffffff; /* لون النص أبيض */
    font-size: 22px;
    margin: 20px auto;
    max-width: 80%;
    text-align: center;
    line-height: 1.5;
    direction: ltr;
    text-shadow: 
        -1px -1px 0 #000000,  
         1px -1px 0 #000000,
        -1px  1px 0 #000000,
         1px  1px 0 #000000; /* إضافة حواف سوداء */
         
}




img {
    max-width: 300px;
    height: auto;
    margin: 20px auto;
    display: block;
    border: 5px solid; /* عرض الإطار */
    border-image: linear-gradient(45deg, #000000, #ff0000, #250f0f) 1;
}



.movie-embed-container, .trailer-container {
    position: relative;
    width: 90%; /* عرض الحاوية مع ترك مسافة على الجوانب */
    max-width: 800px; /* تحديد أقصى عرض للحاوية */
    height: 0; /* الارتفاع سيُحدد بناءً على النسبة */
    padding-top: 56.25%; /* نسبة العرض إلى الارتفاع (16:9) لتحديد الارتفاع تلقائيًا */
    margin: 20px auto; /* توسيط العنصر مع مسافة على الجوانب */
    border: 5px solid; /* عرض الإطار */
    border-image: linear-gradient(45deg, #000000, #ff0000, #250f0f) 1;
    border-image-slice: 1; /* تطبيق خليط الألوان على الإطار */
    overflow: hidden; /* إخفاء أي جزء من الفيديو يتجاوز الحاوية */
    background-color: #000; /* خلفية داكنة لجعل الفيديو يبرز */
    box-sizing: border-box; /* تضمين الإطار في حساب العرض والارتفاع */
}

.movie-embed-container iframe, .trailer-container iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none; /* إزالة الحدود حول الفيديو */
}




.download-button {
    background-color: #00BFFF;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
    border-radius: 5px;
    width: 50%;
    margin-top: 20px;
    align-items: center;
    text-align: center;
    margin-bottom: 50px;
        }

        .download-button:hover {
            transform: scale(1.05) translateZ(15px); /* تكبير المربع وتحريكه في المحور Z */
    background-color: #008CBA;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4); /* زيادة الظل عند التمرير فوق العنصر */
        }


      

        



.carousel-container {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%; /* تأكد من أن الحاوية تأخذ المساحة المطلوبة */
    
}

.carousel-btn {
    cursor: pointer;
    width: 50px; /* عرض الزر */
    height: 50px; /* ارتفاع الزر */
    background-color: #333;
    color: #fff;
    border: none;
    border-radius: 5px; /* يمكن تعديله إلى 0 إذا كنت تريد مربعات حادة الزوايا */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    z-index: 1000; /* تأكد من ظهور الأزرار فوق العناصر الأخرى */
}

.carousel-btn:hover {
    background-color: #f40612;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.7);
}

.carousel-btn:disabled {
    background-color: #666;
    cursor: not-allowed;
}

#prevBtn {
    position: absolute;
    left: -1px; /* يحدد المسافة من اليسار */
    top: 93%;
    transform: translateY(-50%);
    

}

#nextBtn {
    position: absolute;
    right: -1px; /* يحدد المسافة من اليمين */
    top: 93%;
    transform: translateY(-50%);
    
    align-items: center;
    will-change: transform; /* Optimizes performance for transform animations */
}

.carousel-content {
    display: flex;
    overflow-x: auto;
    scroll-behavior: smooth;
    gap: 10px; /* لضبط المسافة بين العناصر */
}














.similar-movie {
    min-width: 200px; /* Minimum width for each movie */
    margin: 0 10px; /* Spacing between posters */
    text-align: center; /* Center text below the poster */
    position: sticky;
}

/* Style for the poster image */
.similar-movie img {
    width: 100%;
    height: auto;
    border-radius: 8px; /* Rounded corners for the poster */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Slight shadow effect */
    transition: transform 0.3s ease; /* Smooth hover effect */
    cursor: pointer;
    position: sticky;
}

/* Movie info (title and year) */
.similar-movie .movie-info {
    margin-top: 10px;
}

/* Movie title */
.similar-movie h3 {
    overflow-wrap: break-word;
    white-space: normal;
    display: inline-block;
    max-width: 100%; /* تأكد من أن النص لن يمتد خارج حدود العنصر */

    /* التحكم في عرض النص */
    width: fit-content; /* يحدد العرض بما يناسب المحتوى */
     color: red;
    
}

/* Release year */
.similar-movie p {
    color: #aaa;
}

/* Hover effect on the poster */
.similar-movie img:hover {
    transform: scale(1.05); /* Slight zoom on hover */
}





    </style>
</head>
<header onclick="window.location.href='/'" style="cursor: pointer;">
    فهرس
</header>
<body>
    
    <div class="movie-details" id="movie-details">
        <img src="" alt="Movie Poster">
        <h1>Movie Title</h1>
        <p><strong>تاريخ الاصدار : </strong> <span id="release-date">N/A</span></p>
        <p><strong>القصة : </strong> <span id="overview">No overview available.</span></p>
        <p><strong>النوع : </strong> <span id="genre">N/A</span></p>
        <p><strong>التقييم : </strong> <span id="rating">N/A</span></p>
        <h2>التريلر</h2>
        <div class="trailer-container" id="trailer-container"></div>
        <h2>مشاهدة الفيلم</h2>
        <div class="movie-embed-container" id="movie-embed-container"></div>
        <h3>اذا لم تظهر الترجمة العربية<br>[cc] اضغط على مربع  
            <br>[ Arabic ] و اختار كلمة 
            <br> و اختار الترجمة المناسبة ، قم بتغيير الترجمة اذا في تاخير او تسريع 
            <br> اذا لم تجد الترجمة المناسبة و جميع الترجمات العربية متاخرة او مسرعة او السيرفر لا يعمل  أرجوك قم بنسخ الرابط و أرساله لنا بسرعة لتغييره  
            <br>  من خلال الذهاب الى صفحة اتصل بنا
            </h3>
            <button id="downloadBtn" class="download-button">تحميل</button>
<div id="similar-movies"></div>
        <a href="Movies">رجوع</a>
    </div>
</header>
    

    <script>
        const apiKey = 'cf64a661774f647b7513facb9f1e55e5';

// Fetch movie details
async function fetchMovieDetails(tmdbId, language = 'ar') {
  const url = `https://api.themoviedb.org/3/movie/${tmdbId}?api_key=${apiKey}&language=${language}`;
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error('Failed to fetch movie details.');
    return await response.json();
  } catch (error) {
    console.error('Error fetching movie details:', error);
    return null;
  }
}

// Fetch similar movies
async function fetchSimilarMovies(tmdbId, genreId) {
  const url = `https://api.themoviedb.org/3/discover/movie?api_key=${apiKey}&with_genres=${genreId}&language=en&sort_by=popularity.desc`;
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error('Failed to fetch similar movies.');
    const data = await response.json();
    return data.results.filter(movie => movie.id !== parseInt(tmdbId));
  } catch (error) {
    console.error('Error fetching similar movies:', error);
    return [];
  }
}

// Fetch movie videos
async function fetchMovieVideos(tmdbId) {
  const url = `https://api.themoviedb.org/3/movie/${tmdbId}/videos?api_key=${apiKey}&language=en`;
  try {
    const response = await fetch(url);
    if (!response.ok) throw new Error('Failed to fetch movie videos.');
    return (await response.json()).results;
  } catch (error) {
    console.error('Error fetching movie videos:', error);
    return [];
  }
}

// Get query parameter from URL
function getQueryParameter(name) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(name);
}

// Display similar movies
async function displaySimilarMovies(tmdbId) {
  const movieData = await fetchMovieDetails(tmdbId);
  if (movieData && movieData.genres.length > 0) {
    const mainGenreId = movieData.genres[0].id;
    const similarMovies = await fetchSimilarMovies(tmdbId, mainGenreId);

    const similarMoviesContainer = document.getElementById('similar-movies');
    if (similarMovies.length > 0) {
      similarMoviesContainer.innerHTML = `
        <h2>أفلام مشابهة</h2>
        <div id="similar-movie-container" class="carousel-container">
          <button id="prevBtn" class="carousel-btn">›</button>
          <div id="similar-movie-content" class="carousel-content"></div>
          <button id="nextBtn" class="carousel-btn">‹</button>
        </div>
      `;

      const similarMovieContent = document.getElementById('similar-movie-content');
      similarMovies.forEach(movie => {
        const movieElement = document.createElement('div');
        movieElement.className = 'similar-movie';
        movieElement.dataset.tmdbId = movie.id;
        movieElement.innerHTML = `
          <img src="https://image.tmdb.org/t/p/w500/${movie.poster_path}" alt="${movie.title}">
          <div class="movie-info">
            <h3>${movie.title}</h3>
            <p>${new Date(movie.release_date).getFullYear() || 'غير متوفر'}</p>
          </div>
        `;
        movieElement.addEventListener('click', () => {
          window.location.href = `watch_movie?tmdb_id=${movie.id}`;
        });
        similarMovieContent.appendChild(movieElement);
      });

      // Carousel functionality
      const carouselContent = document.getElementById('similar-movie-content');
      let index = 0;

      function updateCarousel() {
        const items = carouselContent.querySelectorAll('.similar-movie');
        items.forEach((item, i) => {
          item.style.display = i === index ? 'block' : 'none';
        });
      }

      document.getElementById('nextBtn').addEventListener('click', () => {
        index = (index + 1) % similarMovies.length;
        updateCarousel();
      });

      document.getElementById('prevBtn').addEventListener('click', () => {
        index = (index - 1 + similarMovies.length) % similarMovies.length;
        updateCarousel();
      });

      updateCarousel();
    } else {
      similarMoviesContainer.innerHTML = '<p>لا توجد أفلام مشابهة.</p>';
    }
  }
}

// Display movie details and videos
async function displayMovieDetails() {
  const tmdbId = getQueryParameter('tmdb_id');

  if (!tmdbId) {
    document.getElementById('movie-details').innerHTML = '<p>لم يتم توفير معرّف الفيلم.</p>';
    return;
  }

  await displaySimilarMovies(tmdbId);

  const movieData = await fetchMovieDetails(tmdbId);
  const movieVideos = await fetchMovieVideos(tmdbId);

  if (movieData) {
    document.querySelector('h1').textContent = movieData.title || 'لا يوجد عنوان';
    document.querySelector('img').src = movieData.poster_path ? `https://image.tmdb.org/t/p/w500/${movieData.poster_path}` : '';
    document.getElementById('release-date').textContent = movieData.release_date || 'غير متوفر';
    document.getElementById('overview').textContent = movieData.overview || 'لا يوجد ملخص متاح.';

    // Display genre
    const genres = movieData.genres.map(genre => genre.name).join(', ');
    document.getElementById('genre').textContent = genres || 'غير متوفر';

    // Display rating
    const rating = movieData.vote_average ? movieData.vote_average.toFixed(1) : 'غير متوفر';
    document.getElementById('rating').textContent = `${rating} / 10`;

    // Embed movie
    document.getElementById('movie-embed-container').innerHTML = `
      <iframe src="https://vidsrc.xyz/embed/movie?tmdb=${tmdbId}" allowfullscreen></iframe>
    `;

    // Display trailer
    const trailer = movieVideos.find(video => video.type === 'Trailer' && video.site === 'YouTube');
    if (trailer) {
      document.getElementById('trailer-container').innerHTML = `
        <iframe src="https://www.youtube.com/embed/${trailer.key}" allowfullscreen></iframe>
      `;
    } else {
      document.getElementById('trailer-container').innerHTML = '<p>لا يوجد تريلر متاح.</p>';
    }
  } else {
    document.getElementById('movie-details').innerHTML = '<p>فشل في تحميل تفاصيل الفيلم.</p>';
  }
}

// Initialize
window.onload = displayMovieDetails;


    </script>

</body>
</html>